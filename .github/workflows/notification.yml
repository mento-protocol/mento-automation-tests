name: Notification

on:
  workflow_call:
    inputs:
      JOB_STATUS:
        description: "Test job status"
        required: true
        type: string
      MESSAGE:
        description: "Notification message"
        required: true
        type: string
      JOB_URL:
        description: "Test job URL"
        required: true
        type: string
      REPORT_URL:
        description: "Playwright Report URL"
        required: false
        type: string

    secrets:
      DISCORD_TEST_RUN_WEBHOOK_ID:
        required: true
      DISCORD_TEST_RUN_WEBHOOK_TOKEN:
        required: true

jobs:
  notification:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@master

      - name: Send Discord Notification
        env:
          DISCORD_WEBHOOK: "https://discord.com/api/webhooks/${{ secrets.DISCORD_TEST_RUN_WEBHOOK_ID }}/${{ secrets.DISCORD_TEST_RUN_WEBHOOK_TOKEN }}"
          DISCORD_USERNAME: "Test Run Notifier"
        uses: Ilshidur/action-discord@master
        with:
          args: |
            ${{ inputs.JOB_STATUS == 'success' && '‚úÖ' || '‚ùå' }} ${{ inputs.MESSAGE }}
            üîó [Job](${{ inputs.JOB_URL }})
            ${{ inputs.REPORT_URL && 'üìä [Playwright Report](${{ inputs.REPORT_URL }})' }}
